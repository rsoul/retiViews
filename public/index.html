<html>
<head>
  <style type="text/css">
  .mapboxgl-marker {
    width: 13px;
    height: 13px;
    border-radius: 50%;
    border:1px solid #fff;
    position='absolute';}
  #logo{
    color:#fff;
    font-family: 'IBM Plex Serif',
    serif;
    font-size:40pt;
    padding-top:35px;
    font-weight: 600;
    font-style: italic; 
  }
  .r-titles{
    color:#fff;
    font-family: 'Quicksand', 
    sans-serif;
    font-size:15pt;
    padding-top:20px;
    font-wight:800; 

  }
  .r-text{}
  .event-identifier{}
  .l-titles{}

  </style>
	
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Serif|Quicksand" rel="stylesheet">

	<script src='https://api.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.js'></script>
  <link href='//mapbox.com/base/latest/base.css' rel='stylesheet' />
  <link href='https://api.mapbox.com/mapbox-gl-js/v0.47.0/mapbox-gl.css' rel='stylesheet' />
  <script src='https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.1/socket.io.slim.js'></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

  <script>
    var cars=[];
    var socket = io();
    socket.on('car-info',(data)=>{
      obj=JSON.parse(data);

      var el = document.createElement('div');
      el.style.backgroundColor=obj.color;
      new mapboxgl.Marker(el,).setLngLat(obj.pos).addTo(map);
    })


    
    socket.on('route',(routeURL)=>{
       $.ajax({method: 'GET',url: routeURL}).done((data)=>{
        console.log();
        map.addLayer({id: 'route'+Math.random(),type:'line',source:{type:'geojson',data:{type:'Feature',geometry: data.routes[0].geometry}},paint:{'line-width': 2,'line-color':'white'}});
       })


     })
    
  </script>
</head>

<body>
	
	
  <div style="height: 100%">
  <div id='map' style="height: 100%"></div>
  <div class='pin-right pad2'>
    
  </div>
  <div id='step-4' class='col3 pad2 fill-darken1 pin-left offcanvas-left animate'>
    <a href='#' class='fill-darken2 pad1 icon close'></a>
    <h1> Ur mom </h1>
  </div>
  <div id="r-panel" class='col2 pad2 fill-darken3 pin-right'>
    <a href='#step-4' class='button'>Log out</a>
    <h2 id='logo'>Vie.ws</h2>
    <h3 class='r-titles'> ACTIVE TRIPS</h4>
    <h2 id='logo'>7</h2>
    <h3 class='r-titles'> LIVE EVENTS</h3>
    <div id='livefeed'>
    </div>
   </div>

</div>

<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoicnNvdWxsIiwiYSI6ImNqa2l3c2F0dTFhMTkza28zNXhnMjZ4b3UifQ.EuutLwZpj-2ZD5LVZiDlvw';
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/dark-v9',
    maxZoom: 15,
    minZoom: 1,
    attributionControl: false
  }).setCenter([12.50,41.89]).setZoom(10.8);

</script>

</body>

</html>